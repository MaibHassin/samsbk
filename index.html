<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sam's Book Keeping</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
    }

    h1 {
      text-align: center;
      padding: 15px;
    }

    main {
      width: 90vw;
      margin: auto;
      text-align: center;
    }

    .submit {
      padding: 5px;
      border-radius: 4px;
      background-color: #0a8d0a;
      color: white;
    }

    label:hover {
      cursor: pointer;
    }

    .submit:hover {
      cursor: pointer;
      font-weight: bold;
      background-color: #32cf3a;
    }

    .showdata {
      padding: 5px;
      background-color: #333;
      color: #fff;
      border-radius: 4px;
      border: 2px solid #444;
      margin: 2px;
    }

    .showdata:hover {
      cursor: pointer;
      background-color: #444;
      border: 1px solid #333;
      font-weight: bold;
    }

    .datayear {
      margin: 15px;
      display: flex;
    }

    .seperator {
      font-size: 2em;
      font-weight: bold;
      color: red;
    }

    table {
      border-collapse: collapse;
      margin: auto;
      width: 100%;
    }
    td {
      width: auto;
      padding: 5px;
      border: 1px solid #000;
    }

    section div {
      margin: 10px;
    }

    .data-table {
      text-align: center;
    }

    .show-all-data {
      display: flex;
      margin: 15px;
    }

  </style>
</head>
<body>
  <head>
    <h1>Sam's Book Keeping</h1>
  </head>
  <main>
    <section class="form">
      <div class="input-data">
        <label for="date">Datum</label> <input type="date" name="date" id="date" value="2018-01-01"> <span class="seperator">|</span>
        <label for="name">Naam</label> <input type="text" name="name" id="name"> <span class="seperator">|</span>
        <label for="amount">Amount</label> <input type="number" name="amount" id="amount"> <span class="seperator">|</span>
        <label for="in">in</label> <input type="radio" name="inout" id="in" value="cashin">
        <label for="out">out</label> <input type="radio" name="inout" id="out" value="cashout"> <span class="seperator">|</span>
        <a class="submit" onclick="submitData()">Submit</a>
      </div>
    </section>

    <section class="datalist">
      <div class="show-all-data">
        <a class="all showdata" onclick="showData()">Alle meedingenden</a>
      </div>
      <div class="datayear">
        <a class="dyear showdata" onclick="showDataYear('2018')">Volledig 2018</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '01')">Jan 18</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '02')">Feb 18</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '03')">March 18</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '04')">April 18</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '05')">May 18</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '06')">June 18</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '07')">July 18</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '08')">August 18</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '09')">September 18</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '10')">October 18</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '11')">November 18</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '12')">December 18</a>
      </div>
      <div class="datayear">
        <a class="dyear showdata" onclick="showDataYear('2019')">Volledig 2019</a>
        <a class="dmonth showdata" onclick="showDataMonth('2018', '01')">Jan 19</a>
        <a class="dmonth showdata" onclick="showDataMonth('2019', '02')">Feb 19</a>
        <a class="dmonth showdata" onclick="showDataMonth('2019', '03')">March 19</a>
        <a class="dmonth showdata" onclick="showDataMonth('2019', '04')">April 19</a>
        <a class="dmonth showdata" onclick="showDataMonth('2019', '05')">May 19</a>
        <a class="dmonth showdata" onclick="showDataMonth('2019', '06')">June 19</a>
        <a class="dmonth showdata" onclick="showDataMonth('2019', '07')">July 19</a>
        <a class="dmonth showdata" onclick="showDataMonth('2019', '08')">August 19</a>
        <a class="dmonth showdata" onclick="showDataMonth('2019', '09')">September 19</a>
        <a class="dmonth showdata" onclick="showDataMonth('2019', '10')">October 19</a>
        <a class="dmonth showdata" onclick="showDataMonth('2019', '11')">November 19</a>
        <a class="dmonth showdata" onclick="showDataMonth('2019', '12')">December 19</a>
      </div>
      <div class="datayear">
        <a class="dyear showdata" onclick="showDataYear('2020')">Volledig 2020</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '01')">Jan 20</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '02')">Feb 20</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '03')">March 20</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '04')">April 20</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '05')">May 20</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '06')">June 20</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '07')">July 20</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '08')">August 20</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '09')">September 20</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '10')">October 20</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '11')">November 20</a>
        <a class="dmonth showdata" onclick="showDataMonth('2020', '12')">December 20</a>
      </div>
      <div class="datayear">
        <a class="dyear showdata" onclick="showDataYear('2021')">Volledig 2021</a>
        <a class="dmonth showdata" onclick="showDataMonth('2021', '01')">Jan 21</a>
        <a class="dmonth showdata" onclick="showDataMonth('2021', '02')">Feb 21</a>
        <a class="dmonth showdata" onclick="showDataMonth('2021', '03')">March 21</a>
      </div>
    </section>

    <section class="data-table">
      <table id="producttable">
        <thead>
          <tr>
            <td>Id</td>
            <td>Date</td>
            <td>Description</td>
            <td>In / Out</td>
            <td>Amount</td>
          </tr>
        </thead>
        <tbody>
          <!-- existing data could optionally be included here -->
        </tbody>
      </table>

      <template id="datarow">
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      </template>
    </section>
  </main>

  <script src="https://www.gstatic.com/firebasejs/8.3.0/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
     <script src="https://www.gstatic.com/firebasejs/8.3.0/firebase-auth.js"></script>
     <script src="https://www.gstatic.com/firebasejs/8.3.0/firebase-database.js"></script>

<script>
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
    apiKey: "AIzaSyDr1vGQUtyYv8SKLjdmbEBn2wD32B7TM34",
    authDomain: "my-project-1557233171327.firebaseapp.com",
    databaseURL: "https://my-project-1557233171327.firebaseio.com",
    projectId: "my-project-1557233171327",
    storageBucket: "my-project-1557233171327.appspot.com",
    messagingSenderId: "583723257921",
    appId: "1:583723257921:web:79e0fb08f881502dc576c0",
    measurementId: "G-MZTY1P8DG8"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  var database = firebase.database();
  

  firebase.auth().onAuthStateChanged(() => {
      user = firebase.auth().currentUser
      if (user) {
        // if logged in
      } else {
        console.log('not logged in');
      }
    });
  
    function submitData() {
      let id = new Date().valueOf();
      let date = document.getElementById('date').value;
      let name = document.getElementById('name').value;
      let amount = document.getElementById('amount').value;
      let inout;
      if(document.getElementById('in').checked) {
        inout = 'in';
      } 
      else if (document.getElementById('out').checked) {
        inout = 'out';
        amount *= -1;
      }
      console.log(id, date, name, amount, inout)

      let datarow = {
        id,
        date,
        name,
        amount,
        inout
      }
      firebase.database().ref(user.uid+'/'+id).set(datarow);
      document.querySelector("tbody").innerHTML = ""

    }
    function showData() {
      document.querySelector("tbody").innerHTML = ""
      var tbody = document.querySelector("tbody");

      var template = document.querySelector('#datarow');

      firebase.database().ref(user.uid).orderByChild('date').on('value', function(snapshot){
        snapshot.forEach(function(child) {
          let value = child.val();
          var clone = template.content.cloneNode(true);
          var td = clone.querySelectorAll("td");
          td[0].textContent = value.id;
          td[1].textContent = value.date;
          td[2].textContent = value.name;
          td[3].textContent = value.inout;
          td[4].textContent = value.amount;

          tbody.appendChild(clone);
          // let adate = value.date;
          // let year = adate.split('-');
          // year = year[0];
          // if(year == '2018')
          // {
          //   console.log(value);
          // }
      });
      });
    }

    function showDataYear(datayear) {
      document.querySelector("tbody").innerHTML = ""
      var tbody = document.querySelector("tbody");

      var template = document.querySelector('#datarow');

      firebase.database().ref(user.uid).orderByChild('date').on('value', function(snapshot){
        snapshot.forEach(function(child) {
          let value = child.val();
          var clone = template.content.cloneNode(true);
          var td = clone.querySelectorAll("td");
          let adate = value.date;
          let year = adate.split('-');
          year = year[0];
          if(year == datayear)
          {
            td[0].textContent = value.id;
            td[1].textContent = value.date;
            td[2].textContent = value.name;
            td[3].textContent = value.inout;
            td[4].textContent = value.amount;
            tbody.appendChild(clone);
          }

      });
      });
    }

    function showDataMonth(datayear, datamonth) {
      document.querySelector("tbody").innerHTML = ""
      var tbody = document.querySelector("tbody");

      var template = document.querySelector('#datarow');

      firebase.database().ref(user.uid).orderByChild('date').on('value', function(snapshot){
        snapshot.forEach(function(child) {
          let value = child.val();
          var clone = template.content.cloneNode(true);
          var td = clone.querySelectorAll("td");
          let adate = value.date;
          let sepdate = adate.split('-');
          year = sepdate[0];
          month = sepdate[1];
          if(year == datayear && month == datamonth)
          {
            console.log('here');
            td[0].textContent = value.id;
            td[1].textContent = value.date;
            td[2].textContent = value.name;
            td[3].textContent = value.inout;
            td[4].textContent = value.amount;
            tbody.appendChild(clone);
          }

      });
      });
    }
  </script>
</body>
</html>