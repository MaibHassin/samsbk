<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sam's Book Keeping</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
    }

    h1 {
      text-align: center;
      padding: 15px;
    }

    main {
      width: 90vw;
      margin: auto;
      text-align: center;
    }

    .submit {
      padding: 5px;
      border-radius: 4px;
      background-color: #0a8d0a;
      color: white;
    }

    label:hover {
      cursor: pointer;
    }
    .submit:hover {
      cursor: pointer;
      font-weight: bold;
      background-color: #32cf3a;
    }

    .seperator {
      font-size: 2em;
      font-weight: bold;
      color: red;
    }

    table {
      border-collapse: collapse;
      margin: auto;
      width: 100%;
    }
    td {
      width: auto;
      padding: 5px;
      border: 1px solid #000;
    }

    section div {
      margin: 10px;
    }

    .data-table {
      text-align: center;
    }

  </style>
</head>
<body>
  <head>
    <h1>Sam's Book Keeping</h1>
  </head>
  <main>
    <section class="form">
      <div class="input-data">
        <label for="date">Datum</label> <input type="date" name="date" id="date" value="2018-01-01"> <span class="seperator">|</span>
        <label for="name">Naam</label> <input type="text" name="name" id="name"> <span class="seperator">|</span>
        <label for="amount">Amount</label> <input type="number" name="amount" id="amount"> <span class="seperator">|</span>
        <label for="in">in</label> <input type="radio" name="inout" id="in" value="cashin">
        <label for="out">out</label> <input type="radio" name="inout" id="out" value="cashout"> <span class="seperator">|</span>
        <a class="submit" onclick="submitData()">Submit</a>
      </div>
    </section>

    <section class="datalist">
      <div class="show-all-data">
        <a class="all submit" onclick="showData()">Alle meedingenden</a>
      </div>
      <div class="datayear">
        <a class="dyear">Volledig 2018</a>
        <a class="dmonth">Jan 18</a>
        <a class="dmonth">Feb 18</a>
        <a class="dmonth">March 18</a>
        <a class="dmonth">April 18</a>
        <a class="dmonth">May 18</a>
        <a class="dmonth">June 18</a>
        <a class="dmonth">July 18</a>
        <a class="dmonth">August 18</a>
        <a class="dmonth">September 18</a>
        <a class="dmonth">October 18</a>
        <a class="dmonth">November 18</a>
        <a class="dmonth">December 18</a>
      </div>
      <div class="datayear">
        <a class="dyear">Volledig 2019</a>
        <a class="dmonth">Jan 19</a>
        <a class="dmonth">Feb 19</a>
        <a class="dmonth">March 19</a>
        <a class="dmonth">April 19</a>
        <a class="dmonth">May 19</a>
        <a class="dmonth">June 19</a>
        <a class="dmonth">July 19</a>
        <a class="dmonth">August 19</a>
        <a class="dmonth">September 19</a>
        <a class="dmonth">October 19</a>
        <a class="dmonth">November 19</a>
        <a class="dmonth">December 19</a>
      </div>
      <div class="datayear">
        <a class="dyear">Volledig 2020</a>
        <a class="dmonth">Jan 20</a>
        <a class="dmonth">Feb 20</a>
        <a class="dmonth">March 20</a>
        <a class="dmonth">April 20</a>
        <a class="dmonth">May 20</a>
        <a class="dmonth">June 20</a>
        <a class="dmonth">July 20</a>
        <a class="dmonth">August 20</a>
        <a class="dmonth">September 20</a>
        <a class="dmonth">October 20</a>
        <a class="dmonth">November 20</a>
        <a class="dmonth">December 20</a>
      </div>
      <div class="datayear">
        <a class="dyear">Volledig 2021</a>
        <a class="dmonth">Jan 21</a>
        <a class="dmonth">Feb 21</a>
        <a class="dmonth">March 21</a>
      </div>
    </section>

    <section class="data-table">
      <table id="producttable">
        <thead>
          <tr>
            <td>Id</td>
            <td>Date</td>
            <td>Description</td>
            <td>In / Out</td>
            <td>Amount</td>
          </tr>
        </thead>
        <tbody>
          <!-- existing data could optionally be included here -->
        </tbody>
      </table>

      <template id="datarow">
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      </template>
    </section>
  </main>

  <script src="https://www.gstatic.com/firebasejs/8.3.0/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
     <script src="https://www.gstatic.com/firebasejs/8.3.0/firebase-auth.js"></script>
     <script src="https://www.gstatic.com/firebasejs/8.3.0/firebase-database.js"></script>

<script>
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
    apiKey: "AIzaSyDr1vGQUtyYv8SKLjdmbEBn2wD32B7TM34",
    authDomain: "my-project-1557233171327.firebaseapp.com",
    databaseURL: "https://my-project-1557233171327.firebaseio.com",
    projectId: "my-project-1557233171327",
    storageBucket: "my-project-1557233171327.appspot.com",
    messagingSenderId: "583723257921",
    appId: "1:583723257921:web:79e0fb08f881502dc576c0",
    measurementId: "G-MZTY1P8DG8"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  var database = firebase.database();
  

  firebase.auth().onAuthStateChanged(() => {
      user = firebase.auth().currentUser
      if (user) {
        // if logged in
      } else {
        console.log('not logged in');
      }
    });
  
  function submitData() {
      let id = new Date().valueOf();
      let date = document.getElementById('date').value;
      let name = document.getElementById('name').value;
      let amount = document.getElementById('amount').value;
      let inout;
      if(document.getElementById('in').checked) {
        inout = 'in';
      } 
      else if (document.getElementById('out').checked) {
        inout = 'out';
        amount *= -1;
      }
      console.log(id, date, name, amount, inout)

      let datarow = {
        id,
        date,
        name,
        amount,
        inout
      }

      firebase.database().ref(user.uid+'/'+id).set(datarow);

    }
  function showData() {
    firebase.database().ref(user.uid).orderByChild('inout').on('value', function(snapshot){
      snapshot.forEach(function(child) {
        let value = child.val();

        var tbody = document.querySelector("tbody");
        var template = document.querySelector('#datarow');

        var clone = template.content.cloneNode(true);
        var td = clone.querySelectorAll("td");
        td[0].textContent = value.id;
        td[1].textContent = value.date;
        td[2].textContent = value.name;
        td[3].textContent = value.inout;
        td[4].textContent = value.amount;

        tbody.appendChild(clone);
        // let adate = value.date;
        // let year = adate.split('-');
        // year = year[0];
        // if(year == '2018')
        // {
        //   console.log(value);
        // }
    });
    });
  }
  </script>
</body>
</html>